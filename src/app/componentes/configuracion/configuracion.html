<div class="config-container" [style.--color-sistema]="colorSistemaValue">
    <!-- Sección Información de la Empresa -->
    <div class="config-card mb-4">
        <div class="config-card-header text-center">
            <h3>Información de la empresa</h3>
        </div>
        <div class="config-card-body">
            <div class="empresa-logo-section">
                <div class="logo-preview-container">
                    <img [src]="logoUrl()" alt="Logo Empresa" class="logo-preview">
                </div>
                <button class="btn btn-update-img" (click)="solicitarImagen()">
                    <i class="bi bi-upload"></i> Actualizar imagen
                </button>
            </div>

            <form [formGroup]="empresaForm" (ngSubmit)="actualizarEmpresa()" class="empresa-form mt-4">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="NombreComercial">Empresa</label>
                        <input type="text" id="NombreComercial" formControlName="NombreComercial"
                            placeholder="Nombre de la empresa"
                            [class.invalid]="empresaForm.get('NombreComercial')?.invalid && empresaForm.get('NombreComercial')?.touched">
                    </div>
                    <div class="form-group">
                        <label for="NombrePropietario">Propietario</label>
                        <input type="text" id="NombrePropietario" formControlName="NombrePropietario"
                            placeholder="Nombre del propietario"
                            [class.invalid]="empresaForm.get('NombrePropietario')?.invalid && empresaForm.get('NombrePropietario')?.touched">
                    </div>
                    <div class="form-group">
                        <label for="Correo">Correo</label>
                        <input type="email" id="Correo" formControlName="Correo" placeholder="correo@ejemplo.com"
                            [class.invalid]="empresaForm.get('Correo')?.invalid && empresaForm.get('Correo')?.touched">
                    </div>
                    <div class="form-group">
                        <label for="Telefono">Teléfono</label>
                        <input type="text" id="Telefono" formControlName="Telefono" placeholder="Número de teléfono"
                            [class.invalid]="empresaForm.get('Telefono')?.invalid && empresaForm.get('Telefono')?.touched">
                    </div>
                    <div class="form-group">
                        <label for="Departamento">Departamento</label>
                        <input type="text" id="Departamento" formControlName="Departamento" placeholder="Departamento"
                            [class.invalid]="empresaForm.get('Departamento')?.invalid && empresaForm.get('Departamento')?.touched">
                    </div>
                    <div class="form-group">
                        <label for="Municipio">Municipio</label>
                        <input type="text" id="Municipio" formControlName="Municipio" placeholder="Municipio"
                            [class.invalid]="empresaForm.get('Municipio')?.invalid && empresaForm.get('Municipio')?.touched">
                    </div>
                    <!-- Razon Social -->
                    <div class="form-group">
                        <label for="RazonSocial">Razón Social</label>
                        <input type="text" id="RazonSocial" formControlName="RazonSocial"
                            placeholder="Razón social de la empresa">
                    </div>
                    <!-- NIT -->
                    <div class="form-group">
                        <label for="NIT">NIT</label>
                        <input type="text" id="NIT" formControlName="NIT" placeholder="NIT de la empresa">
                    </div>
                    <!-- Direccion -->
                    <div class="form-group">
                        <label for="Direccion">Dirección</label>
                        <input type="text" id="Direccion" formControlName="Direccion"
                            placeholder="Dirección de la empresa">
                    </div>
                </div>
                <div class="text-end mt-3">
                    <button type="submit" class="btn btn-actualizar">
                        <i class="bi bi-arrow-clockwise"></i> Actualizar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sección Información de Mesas -->
    <div class="config-card">
        <div class="config-card-header text-center">
            <h3>Información de mesas</h3>
        </div>
        <div class="config-card-body">
            <div class="d-flex justify-content-end mb-3">
                <button class="btn btn-crear-mesa" (click)="crearMesas()">
                    <i class="bi bi-grid-3x3-gap"></i> Crear Mesas
                </button>
            </div>

            <div class="table-container">
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>No. <i class="bi bi-arrow-down-up"></i></th>
                            <th>Clasificación <i class="bi bi-arrow-down-up"></i></th>
                            <th>Nombre de mesa <i class="bi bi-arrow-down-up"></i></th>
                            <th># Mesas <i class="bi bi-arrow-down-up"></i></th>
                            <th class="text-center">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (mesa of mesasPaginadas(); track mesa.CodigoMesa) {
                        <tr>
                            <td>{{ formatearNumero(mesa.CodigoMesa) }}</td>
                            <td>{{ mesa.NombreClasificacion }}</td>
                            <td>{{ mesa.NombreMesa }}</td>
                            <td>{{ mesa.CantidadMesas }}</td>
                            <td class="acciones-cell">
                                <button class="btn-accion btn-editar" (click)="editarMesa(mesa)" title="Editar">
                                    <i class="bi bi-pencil-square"></i>
                                </button>
                                <button class="btn-accion btn-eliminar" (click)="eliminarMesa(mesa)" title="Eliminar">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </td>
                        </tr>
                        } @empty {
                        <tr>
                            <td colspan="5" class="text-center py-4 text-muted">No hay configuraciones de mesas</td>
                        </tr>
                        }
                    </tbody>
                </table>
            </div>

            <!-- Paginación -->
            <div class="paginacion-container mt-3">
                <span class="paginacion-info">
                    Mostrando {{ rangoInicio() }} al {{ rangoFin() }} de {{ totalRegistros() }} registros
                </span>
                <div class="paginacion-controles">
                    <button class="btn-paginacion" (click)="paginaAnterior()" [disabled]="paginaActual() === 1">
                        <i class="bi bi-chevron-left"></i>
                    </button>
                    @for (p of paginasArray(); track p) {
                    <button class="btn-paginacion" [class.activo]="paginaActual() === p" (click)="irAPagina(p)">
                        {{ p }}
                    </button>
                    }
                    <button class="btn-paginacion" (click)="paginaSiguiente()"
                        [disabled]="paginaActual() === totalPaginas() || totalPaginas() === 0">
                        <i class="bi bi-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modales -->
    <app-modal-mesa [visible]="mostrarModalMesa()" [mesaAEditar]="mesaAEditar()" [clasificaciones]="clasificaciones()"
        (alRefrescarClasificaciones)="cargarClasificaciones()" (alCerrar)="cerrarModalMesa()"
        (alGuardar)="manejarGuardarMesa($event)">
    </app-modal-mesa>
</div>