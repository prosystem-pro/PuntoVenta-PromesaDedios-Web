<div class="roles-container" [style.--color-sistema]="colorSistema">
    <!-- Header con botones y titulo -->
    <div class="roles-header">
        <button class="btn btn-export" [style.background-color]="colorSistema" (click)="exportarExcel()">
            <i class="bi bi-file-earmark-spreadsheet"></i> Exportar a exel
        </button>

        <h2 class="roles-titulo" [style.color]="colorSistema">
            LISTADO ROLES
        </h2>

        <button class="btn btn-crear" [style.background-color]="colorSistema" (click)="crearRol()">
            <i class="bi bi-shield-lock"></i> Crear Rol
        </button>
    </div>

    <!-- Barra de busqueda -->
    <div class="search-container mb-4">
        <div class="search-box">
            <input type="text" class="search-input" placeholder="Buscar" [value]="textoBusqueda()"
                (input)="alCambiarBusqueda($event)">
            <i class="bi bi-search search-icon"></i>
        </div>
    </div>

    <!-- Table Section -->
    <div class="roles-card shadow-sm border-0">
        <div class="table-container p-0">
            <div *ngIf="cargando()" class="text-center py-5">
                <div class="spinner-border" [style.color]="colorSistema" role="status">
                    <span class="visually-hidden">Cargando...</span>
                </div>
                <p class="mt-2 text-muted">Cargando roles...</p>
            </div>

            <table *ngIf="!cargando()" class="roles-table">
                <thead>
                    <tr>
                        <th>No. <i class="bi bi-arrow-down-up ms-1 small text-muted"></i></th>
                        <th class="text-start">Nombre <i class="bi bi-arrow-down-up ms-1 small text-muted"></i></th>
                        <th class="text-center"># Usuarios <i class="bi bi-arrow-down-up ms-1 small text-muted"></i>
                        </th>
                        <th class="text-center"># Permisos <i class="bi bi-arrow-down-up ms-1 small text-muted"></i>
                        </th>
                        <th class="text-center">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let rol of rolesPaginados(); let i = index">
                        <td>{{ ((paginaActual() - 1) * itemsPorPagina + i + 1) | number:'2.0-0' }}</td>
                        <td class="text-start">{{ rol.NombreRol }}</td>
                        <td class="text-center">{{ rol.CantidadUsuarios || 0 }}</td>
                        <td class="text-center">{{ rol.CantidadPermisos || 0 }}</td>
                        <td class="acciones-cell text-center">
                            <div class="acciones-container">
                                <button class="btn-accion btn-editar" title="Editar" (click)="editarRol(rol)">
                                    <i class="bi bi-pencil-fill"></i>
                                </button>
                                <button class="btn-accion btn-eliminar" title="Eliminar"
                                    (click)="eliminarRol(rol.CodigoRol)">
                                    <i class="bi bi-trash-fill"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    <tr *ngIf="rolesPaginados().length === 0">
                        <td colspan="5" class="text-center py-5 text-muted">No se encontraron roles</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Footer con Paginacion -->
    <div class="card-footer d-flex justify-content-between align-items-center bg-white border-top-0 p-4">
        <div class="pagination-info text-muted small">
            Mostrando <strong>{{ rangoInicio() }}</strong> al <strong>{{ rangoFin() }}</strong> de <strong>{{
                totalRegistros() }}</strong> registros
        </div>

        <nav aria-label="Navegacion" class="pagination-nav">
            <ul class="pagination pagination-sm m-0">
                <li class="page-item" [class.disabled]="paginaActual() === 1">
                    <button class="page-link" (click)="paginaAnterior()">
                        <i class="bi bi-chevron-left"></i>
                    </button>
                </li>

                <li class="page-item" *ngFor="let p of [].constructor(totalPaginas()); let i = index"
                    [class.active]="paginaActual() === i + 1">
                    <button class="page-link" (click)="irAPagina(i + 1)"
                        [style.backgroundColor]="paginaActual() === i + 1 ? colorSistema : ''"
                        [style.borderColor]="paginaActual() === i + 1 ? colorSistema : ''">
                        {{ i + 1 }}
                    </button>
                </li>

                <li class="page-item" [class.disabled]="paginaActual() === totalPaginas() || totalPaginas() === 0">
                    <button class="page-link" (click)="paginaSiguiente()">
                        <i class="bi bi-chevron-right"></i>
                    </button>
                </li>
            </ul>
        </nav>
    </div>
</div>

<!-- Modal -->
<app-modal-rol [visible]="mostrarModal()" [colorSistema]="colorSistema" [rolAEditar]="rolSeleccionado()"
    (alCerrar)="cerrarModal()" (alGuardar)="manejarGuardarRol($event)">
</app-modal-rol>